(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{140:function(e,t,n){},141:function(e,t,n){},146:function(e,t){},148:function(e,t){},164:function(e,t){},166:function(e,t){},192:function(e,t){},193:function(e,t){},203:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(19),i=n.n(s),r=(n(140),n(91)),o=n(32),u=(n(141),n(126)),l=n.n(u),j=n(206),b=n(63),f=n(36),p=n(48),m=n(210),h=n(208),O=n(209),d=n(207),g=(n(199),n(14)),x=j.a.Meta;Array.prototype.avg=function(e){var t=0;return"[object Function]"===Object.prototype.toString.call(e)&&(t=this.reduce((function(t,n,c){return t+e(n,c)}),0)),t/this.length};var y=function(){var e={connectTimeout:4e3,clientId:function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,c="",a=0;a<e;a++)c+=t.charAt(Math.floor(Math.random()*n));return c}(30),username:"wjmWeb",password:"wjmWeb"},t=Object(c.useState)(null),n=Object(o.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)([]),u=Object(o.a)(i,2),y=u[0],v=u[1],S=Object(c.useState)({}),w=Object(o.a)(S,2),E=w[0],N=w[1],C=Object(c.useState)([]),k=Object(o.a)(C,2),M=k[0],z=k[1],F=Object(c.useState)([]),J=Object(o.a)(F,2),T=J[0],B=J[1],A=Object(c.useState)(!1),P=Object(o.a)(A,2),R=P[0],I=P[1],L=Object(c.useState)({}),W=Object(o.a)(L,2),D=W[0],Q=W[1],q=Object(c.useState)({}),G=Object(o.a)(q,2),H=G[0],K=G[1],X=Object(c.useState)(""),Y=Object(o.a)(X,2),Z=Y[0],U=Y[1],V=Object(c.useState)(!0),$=Object(o.a)(V,2),_=$[0],ee=$[1],te=Object(c.useState)(!1),ne=Object(o.a)(te,2),ce=ne[0],ae=ne[1],se=Object(c.useState)(""),ie=Object(o.a)(se,2),re=ie[0],oe=ie[1];return Object(c.useEffect)((function(){return function(){a&&a.end((function(){}))}}),[]),Object(c.useEffect)((function(){a&&(a.on("connect",(function(){a.subscribe(re,{qos:0},(function(e){console.log("subscribe temp topic")}))})),a.on("error",(function(e){console.error("Connection error: ",e),a.end()})),a.on("message",(function(e,t){t.toString();N(JSON.parse(t.toString())||null)})))}),[a]),Object(c.useEffect)((function(){var e=E.phone,t=E.name,n=E.num,c=E.msg;y.forEach((function(a){a.phone==e&&(a.name=t,a.num=n,a.msg=c)})),e&&v([].concat(Object(r.a)(y),[E]))}),[E]),Object(c.useEffect)((function(){var e=function(e,t){var n=new Map;return e.forEach((function(e,c){n.has(e[t])||n.set(e[t],e)})),Object(r.a)(n.values())},t=e(y,"phone").filter((function(e){return 8080!==e.num}));K(t),z(e(y,"phone"))}),[y]),Object(g.jsxs)("div",{className:"App",children:[Object(g.jsxs)(j.a,{style:{marginBottom:20},bodyStyle:{padding:"20px"},children:[Object(g.jsxs)(b.a,{align:"middle",gutter:[4,20],children:[Object(g.jsx)(f.a,{sm:{span:6},xs:{span:24},children:Object(g.jsx)(p.a,{type:"primary",onClick:function(){ae(!0)},children:" \u5c0f\u7a0b\u5e8f\u7801 "})}),Object(g.jsx)(f.a,{sm:{span:6},xs:{span:24},children:Object(g.jsx)(p.a,{type:"primary",onClick:function(){I(!0);var e=Object(r.a)(M).filter((function(e){return 8080!==e.num}));e.sort((function(e,t){return e.num<t.num?1:-1})),B(e);var t=[];function n(e){if(e.length){if(1===e.length)return 1;var t,n={},c=0;return e.forEach((function(e){n[e]?n[e]+=1:n[e]=1,n[e]>c&&(t=e,c=n[e])})),{maxName:t,maxNum:c}}}e.forEach((function(e){t.push(e.num)})),console.log(n(t)),Q(n(t));var c=e.filter((function(e){return 9999!==e.num}));c.length>3&&(c.splice(0,1),c.splice(c.length-1,1)),console.log(c),U(c.avg((function(e){return e.num}))),M.forEach((function(e){a.publish(e.phone,JSON.stringify({type:2}))}))},children:" \u7ed3\u675f\u672c\u6b21\u8bc4\u6d4b "})}),Object(g.jsx)(f.a,{sm:{span:6},xs:{span:24},children:Object(g.jsx)(p.a,{type:"primary",onClick:function(){I(!1),B([]),M.forEach((function(e){e.num=0})),z(M),M.forEach((function(e){a.publish(e.phone,JSON.stringify({type:1}))}))},children:" \u5f00\u59cb\u65b0\u4e00\u8f6e\u8bc4\u6d4b "})}),Object(g.jsxs)(f.a,{sm:{span:6},xs:{span:24},children:["\u5f53\u524d\u5728\u7ebf\u8bc4\u6d4b\u4eba\u6570\uff1a ",M.length," / Ready\u4eba\u6570\uff1a",H.length]})]}),0!==T.length&&Object(g.jsxs)(b.a,{style:{marginTop:20,fontSize:"30px"},align:"middle",gutter:[4,20],children:[Object(g.jsxs)(f.a,{sm:{span:6},xs:{span:24},children:["\u6700\u5927\u503c\uff1a ",T[0]&&9999===T[0].num?"\u221e":T[0]&&T[0].num]}),Object(g.jsxs)(f.a,{sm:{span:6},xs:{span:24},children:["\u5e73\u5747\u503c\uff1a ",Z?Math.ceil(Z):"\u221e"]}),Object(g.jsxs)(f.a,{sm:{span:6},xs:{span:24},children:["\u6700\u5c0f\u503c\uff1a ",T[0]&&9999===T[T.length-1].num?"\u221e":T[0]&&T[T.length-1].num]}),Object(g.jsxs)(f.a,{sm:{span:6},xs:{span:24},children:["\u6b21\u6570\u6700\u591a \uff1a",D.maxNum>1&&Object(g.jsxs)("span",{children:[D.maxName," \u51fa\u73b0\u4e86\uff1a",D.maxNum," \u6b21"]})]}),T[0]&&9999===T[0].num&&Object(g.jsx)("span",{style:{marginLeft:"20px",fontSize:"14px"},children:"\u65e0\u7a77\u5927\u672a\u53c2\u4e0e\u5e73\u5747\u503c\u8ba1\u7b97"})]})]}),Object(g.jsx)(m.b,{size:[8,16],wrap:!0,children:M.map((function(e,t){return Object(g.jsx)(j.a,{hoverable:!0,style:{width:250,height:390},cover:Object(g.jsx)("img",{className:"img",alt:"example",src:8080==e.num?"./img/Notready.jpg":R?"./img/card".concat(9999===e.num?"big":e.num,".png"):"./img/cardgif.gif"}),children:Object(g.jsx)(x,{avatar:Object(g.jsx)(h.a,{size:70,children:e.name}),title:"".concat(8080==e.num?"Not Ready":"Ready"),description:"".concat(1==e.msg?"\u5728\u7ebf":"\u672a\u5728\u7ebf")})},t)}))}),Object(g.jsx)(O.a,{cancelButtonProps:{disabled:!0},closable:!1,title:"\u8bf7\u8f93\u5165\u623f\u95f4\u53f7",visible:_,onOk:function(){var t,n;ee(!1),t="wss://www.wjmwjh.top:5050",n=e,s(l.a.connect(t,n))},children:Object(g.jsx)(d.a,{placeholder:"\u8bf7\u8f93\u5165\u623f\u95f4\u53f7",value:re,onChange:function(e){oe(e.target.value)}})}),Object(g.jsxs)(O.a,{onCancel:function(){ae(!1)},width:345,footer:null,title:"\u5c0f\u7a0b\u5e8f\u4e8c\u7ef4\u7801",visible:ce,children:[Object(g.jsx)("img",{style:{width:"300px",height:"300px"},src:"./img/wxQrCode.jpg",alt:""}),Object(g.jsxs)("div",{style:{fontSize:"28px",marginTop:"20px",color:"red"},children:["\u623f\u95f4\u53f7\uff1a",re]})]})]})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,211)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),s(e),i(e)}))};i.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(y,{})}),document.getElementById("root")),v()}},[[203,1,2]]]);
//# sourceMappingURL=main.72b83f99.chunk.js.map